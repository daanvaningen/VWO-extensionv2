(function(d, w){
  const app = d.getElementById('app');

  chrome.runtime.getBackgroundPage(function(bg){
    if(bg.sessionDataHTML){
      document.body.innerHTML = bg.sessionDataHTML; 
    }
    setInterval(function(){
      bg.sessionDataHTML = document.body.innerHTML
    },1000);    

    //do the rest of your work here.
  })

  // Eventlistener for content script
  chrome.runtime.onMessage.addListener(
    function(request) {
    console.log(request);
    console.log(request.valid);

    // Validity checks if VWO is on page
    if (request.valid === 0) {
      notAvailable();
      console.log('not available');
    } else if (request.valid === 1){
      initVWO(request);
      console.log('not available');
    }
  });

  // If VWO is not on site
  function notAvailable() {
    app.querySelector('.loading').remove();
    const notFound = document.createElement('div');
          notFound.innerHTML = 'VWO not found on this page';
    app.appendChild(notFound);
  }

  // If VWO is on site
  function initVWO(VWOData){
    app.querySelector('.loading').remove();

    const accID = VWOData.accID;
    const userID = VWOData.userID;
    const experiments = VWOData.experiments;

    const accElement = document.createElement('div');
          accElement.innerHTML = accID;

    const userElement = document.createElement('div');
          userElement.innerHTML = userID;

    const experimentsElement = document.createElement('div');

    app.appendChild(accElement);
    app.appendChild(userElement);
    app.appendChild(experimentsElement);

  }

})(document, window);


  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["./js/content-script.js"]
    }
  ],